<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raccon Jobs</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./Raccon/generateDummyData.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand mt-2 mt-lg-0" href="#">
            <img src="/img/raccoon.svg" height="50" loading="lazy" /> Raccoon Jobs
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#">Ver vagas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Habilidades</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Cargos</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Sou empresa</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- NOME DA EMPRESA.-->
        <div class="mt-2">
            <div class="col bg-dark">
                <div class="p-3">
                    <h2 class="font-weight-bold text-white" id="empresaTitulo">Company Solutions contrata:</h2>
                </div>
            </div>
        </div>
        <div class="bg-light container">
            <!-- DESCRIÇAO DA VAGA-->
            <div class="row p-2">
                <div class="col-sm-12">
                    <div class="row">
                        <div class="ratio ratio-1x1 col-sm-3">
                            <img src="" id="logoEmpresa" class="img-fluid rounded align-items-center" alt="LogoDaEmpresa">
                        </div>
                        <div class="col-sm-9">
                            <div class="row">
                                <h4 class="col-sm-12 p-0" id="cargoTitulo">Desenvolvedor Full Stack</h4>
                                <div>
                                    <div class="row">
                                        <p class="col-sm-12 col-md-6 col-lg-10"><b>Data de Cadastro da vaga:</b></p>
                                        <p class="col-sm-12 col-md-6 col-lg-2" id="dataCadastro"><b></b> 08/05</p>
                                    </div>
                                    <div class="row">
                                        <p class="col-sm-12 col-md-6 col-lg-10"><b>Prazo de candidatura:</b></p>
                                        <p class="col-sm-12 col-md-6 col-lg-2" id="candidaturaPrazo"><b></b></p>
                                    </div>
                                    <div class="row">
                                        <p class="col-sm-12 col-md-6 col-lg-10"><b>N de Candidatos:</b></p>
                                        <p class="col-sm-12 col-md-6 col-lg-2" id="candidaturaN"><b>N de
                                                Candidatos:</b> 64 </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <!--DESCRIÇAO-->
                <div class="mt-5">
                    <h5> DESCRIÇAO:</h5>
                    <div class="t-center border p-3 ">
                        <p class="row-md-2 p-2 text-justify" id="vagaDescricao">
                            Estamos buscando um desenvolvedor full stack que seja versátil, apaixonado por tecnologia e
                            soluções inovadoras. Nosso ambiente
                            de trabalho é desafiador, ágil e em constante evolução. O candidato ideal deve ter fortes
                            habilidades analíticas, um compromisso inabalável com a qualidade e a facilidade com
                            trabalho colaborativo! O que você precisa saber: JavaScript, Node.JS, PHP, React, SQL,
                            CI/CD (Jekins, GitHub). Como construir e consumir API's: Rest e RestFull, Webhooks
                        </p>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <!--HABILIDADES-->
                <h5 class="mb-3">HABILIDADES</h5>
                <div id="hab_ess" class="row text-center ml-2 ">
                    
                </div>
                <!--HABILIDADES DIFERENCIADAS-->
                <h5 class="mt-3 mb-3">HABILIDADES DIFERENCIADAS</h5>
                <div id="hab_dif" class="row text-center ml-2 ">
                    
                </div>
                <div>
                    <!--COMO SE CANDIDATAR-->
                    <h5 class="background mt-5">COMO SE CANDIDATAR</h5>
                    <div class="p-3 bg-light">
                        <div class="row">
                            <div class="col-sm-6 col-md-6 col-lg-2">
                                <a class="navbar-brand mt-2 mt-lg-0" href="#">
                                    <img src="" id="logoEmpresa2" height="150" width="150">
                                </a>
                            </div>
                            <div class="col-sm-6 col-md-6 col-lg-10">
                                <h3 href="#" id="empresaTitulo2" class="col-sm-12 col-md-6 col-lg-12"><b>Company Solutions</h3>
                                <p>
                                <a href="#" id="e-mail" class="col-sm-12 col-md-6 col-lg-12"></a>
                                <p><a href="#" id="linkedin" class="col-sm-12 col-md-6 col-lg-12">Linkedin: in/raccon</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="text-center text-lg-start bg-light text-muted">
        <div class="text-center p-4 bg-light">
        © 2021 Copyright:
        <a class="fw-bold" href="#">Trash Panda</a>
        </div>
    </footer>
    <script>
        window.onload = (event) => {
            //esse codigo é temporario enquanto não adicionamos os links.
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id')
            if(!id){
                window.location.replace('?id=1');
            }
        }
    </script>

    <script>

    const fullDateString = (date) => {let dt = new Date(date); return `${dt.getDate()}/${dt.getMonth()+1}/${dt.getFullYear()}`; }
    function habsToPill(habs, max, col){
            let div = ''
            for(vl in habs){
                if(vl < max){
                    if(vl % 2 == 0){
                        div += `<p id="skill-${vl}" class="col-sm-${col} rounded-pill bg-warning">${habs[vl].nome} </p>`
                    }else{
                        div += `<p id="skill-${vl}" class="col-sm-${col} rounded-pill bg-info">${habs[vl].nome}</p>`
                    }
                }
            }
            return div
        }
    const urlParams = new URLSearchParams(window.location.search); 

    const id = urlParams.get('id') 

    let todasEmpresas = JSON.parse(localStorage.getItem('Empresas'))
    let empresaEncontrada = todasEmpresas.find(Empresa => Empresa.id === 2);
    

    let vaga = JSON.parse(localStorage.getItem('Vagas')).find(obj => obj.id === parseInt(id));
    let empresa = JSON.parse(localStorage.getItem('Empresas')).find(obj => obj.id ===  vaga.empresa_id)
    let contato = JSON.parse(localStorage.getItem('Contato')).find(obj => obj.id ===  empresa.contato_id)        
    let hab_ess = JSON.parse(localStorage.getItem('Habilidades')).filter(obj => vaga.hab_essencial_id.includes(obj.id))
    let hab_dif = JSON.parse(localStorage.getItem('Habilidades')).filter(obj => vaga.hab_dif_id.includes(obj.id))
  
    

   
    
    


    if (id) { 
        document.getElementById("empresaTitulo").innerHTML = `${empresa.nome } Contrata:`
        document.getElementById("empresaTitulo2").innerHTML = empresa.nome
        document.getElementById("cargoTitulo").innerHTML = vaga.vaga_nome
        document.getElementById("dataCadastro").innerHTML = fullDateString( vaga.data_cadastro)
        document.getElementById("candidaturaPrazo").innerHTML =  fullDateString(vaga.data_exp)
        document.getElementById("candidaturaN").innerHTML = vaga.candidaturas
        document.getElementById("vagaDescricao").innerHTML = vaga.descricao
        document.getElementById("e-mail").innerHTML = contato.email
        document.getElementById("linkedin").innerHTML= contato.linkedin
        document.getElementById("e-mail").src = contato.email
        document.getElementById("linkedin").src = contato.linkedin
        document.getElementById("logoEmpresa").src = empresa.logo_link
        document.getElementById("logoEmpresa2").src = empresa.logo_link


    

        document.getElementById("hab_ess").innerHTML = habsToPill(hab_ess,10,2)
        document.getElementById("hab_dif").innerHTML = habsToPill(hab_dif,10,2)
        }
    </script>

    <script>
        // <![CDATA[  <-- For SVG support
        if ('WebSocket' in window) {
            (function () {
                function refreshCSS() {
                    var sheets = [].slice.call(document.getElementsByTagName("link"));
                    var head = document.getElementsByTagName("head")[0];
                    for (var i = 0; i < sheets.length; ++i) {
                        var elem = sheets[i];
                        var parent = elem.parentElement || head;
                        parent.removeChild(elem);
                        var rel = elem.rel;
                        if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
                            var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
                            elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
                        }
                        parent.appendChild(elem);
                    }
                }
                var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
                var address = protocol + window.location.host + window.location.pathname + '/ws';
                var socket = new WebSocket(address);
                socket.onmessage = function (msg) {
                    if (msg.data == 'reload') window.location.reload();
                    else if (msg.data == 'refreshcss') refreshCSS();
                };
                if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
                    console.log('Live reload enabled.');
                    sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
                }
            })();
        }
        else {
            console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
        }
	// ]]>
    </script>
    <!-- Code injected by live-server -->
    <script>
        // <![CDATA[  <-- For SVG support
        if ('WebSocket' in window) {
            (function () {
                function refreshCSS() {
                    var sheets = [].slice.call(document.getElementsByTagName("link"));
                    var head = document.getElementsByTagName("head")[0];
                    for (var i = 0; i < sheets.length; ++i) {
                        var elem = sheets[i];
                        var parent = elem.parentElement || head;
                        parent.removeChild(elem);
                        var rel = elem.rel;
                        if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
                            var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
                            elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
                        }
                        parent.appendChild(elem);
                    }
                }
                var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
                var address = protocol + window.location.host + window.location.pathname + '/ws';
                var socket = new WebSocket(address);
                socket.onmessage = function (msg) {
                    if (msg.data == 'reload') window.location.reload();
                    else if (msg.data == 'refreshcss') refreshCSS();
                };
                if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
                    console.log('Live reload enabled.');
                    sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
                }
            })();
        }
        else {
            console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
        }
	// ]]>
    </script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>

</html>
